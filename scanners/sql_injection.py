import requests
import logging
from config import SQL_PAYLOADS

def scan_sql_injection(url):
    for payload in SQL_PAYLOADS:
        target_url = f"{url}{payload}"
        try:
            response = requests.get(target_url)
            if any(error in response.text.lower() for error in
                   ["mysql", "syntax", "odbc", "oracle", "sql server"]):
                print(f"SQL Injection vulnerability found with payload: {payload}")
                logging.info(f"SQL Injection vulnerability found with payload: {payload}")
                return True
        except requests.RequestException as e:
            logging.error(f"[ERROR] Request failed for {target_url}: {e}")
    return False