import requests
from bs4 import BeautifulSoup
import logging

def scan_csrf(url):
    try:
        response = requests.get(url)
        soup = BeautifulSoup(response.content, "html.parser")
        forms = soup.find_all("form")
        for form in forms:
            form_action = form.get("action")
            form_url = url + form_action if form_action else url
            if "csrf" not in form.text.lower():
                print(f"Potential CSRF vulnerability found in form at {form_url}")
                logging.info(f"Potential CSRF vulnerability found in form at {form_url}")
                return True
    except requests.RequestException as e:
        logging.error(f"[ERROR] Failed to request URL {url}: {e}")
    return False