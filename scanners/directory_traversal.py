import requests
import logging
from config import TRAVERSAL_PAYLOADS

def scan_directory_traversal(url):
    for payload in TRAVERSAL_PAYLOADS:
        target_url = f"{url}{payload}etc/passwd"
        try:
            response = requests.get(target_url)
            if "root:" in response.text:
                print(f"Directory Traversal vulnerability found with payload: {payload}")
                logging.info(f"Directory Traversal vulnerability found with payload: {payload}")
                return True
        except requests.RequestException as e:
            logging.error(f"[ERROR] Request failed for {target_url}: {e}")
    return False