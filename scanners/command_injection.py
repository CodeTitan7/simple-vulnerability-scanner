import requests
import logging
from config import COMMAND_INJECTION_PAYLOADS

def scan_command_injection(url):
    for payload in COMMAND_INJECTION_PAYLOADS:
        target_url = f"{url}{payload}"
        try:
            response = requests.get(target_url)
            if "root" in response.text or "uid=" in response.text:
                print(f"Command Injection vulnerability found with payload: {payload}")
                logging.info(f"Command Injection vulnerability found with payload: {payload}")
                return True
        except requests.RequestException as e:
            logging.error(f"[ERROR] Request failed for {target_url}: {e}")
    return False